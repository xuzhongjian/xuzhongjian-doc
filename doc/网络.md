# 网络 #

## 计算机网络 N 层结构 ##
五层：
	应用层
	传输层
	网络层
	数据链路层
	物理层

四层：
	应用层
	传输层
	网络层
	网络接口层

七层：
	应用层
	表示层
	会话层
	传输层
	网络层
	数据链路层
	物理层

## DNS协议 ##

1、在浏览器中输入 www.xuzhongjian.com 操作系统会检查 hosts 文件，如果存在这个域名的对应的ip地址，就首先使用这个 IP 地址。
2、如果没有，就会查找本地 DNS 服务器。如果本地 DNS 服务器内存在这个域名对应的 IP 地址，那么就返回。
3、如果没有，就会将请求转发到 13 个根服务器，然后由根域名服务器请求 .com 对应的 IP 地址，然后在由该服务器查找 xuzhongjian.com 对应的 IP 地址。
4、找到 xuzhongjian.com 的 IP 地址之后，向这个地址请求 www.xuzhongjian.com 的 IP 地址，这样完成了一次 DNS 解析的过程。

从本地查询到本地 DNS 服务器的查询是递归查询，从本地 DNS 服务器到根服务器、一级 DNS 服务器的查询是迭代查询。

## HTTP ##

GET		获取资源
DELETE	删除资源
PUT 	（按照客户端）创建资源，幂等，或者更新资源
POST	（按照服务端）创建资源，或者更新资源

### GET和POST的区别 ###

1. 按照 HTTP 协议的定义，GET 用来获取资源， POST 用来上传资源。
2. GET 的参数拼接在URL的后面， POST 的参数在实体主体中。
3. GET 方法是幂等的，但是 POST 不是。

### HTTPS加密 ###
对称加密：
	使用同一个密钥来对来加密和解密。

	+ 运算速度快
	+ 没办法安全的将密钥发送给对方

非对称加密：
	使用不同的密钥加密。
	+ 可以公开的将密钥发送给对方
	+ 运算速度慢

HTTPS不是新协议，HTTPS是HTTP先和SSL通信，然后由SSL和TCP进行通信，SSL使用的是加密方式是由对称加密和非对称加密混合的加密：
1. 客户端向服务端发起请求，服务端将【公钥】返回给客户端。
2. 客户端获取到【公钥】之后，生成一个【会话密钥】，使用【公钥】将【会话密钥】加密。
3. 将加密后的【会话密钥】传送给服务端。
4. 服务端使用【私钥】解密，获取【会话密钥】。
5. 客户端和服务端通过【会话密钥】进行通信。

上面的【公钥】和【私钥】使用的是非对称加密，【会话密钥】使用的是对称加密。

### 状态码 ###

200 OK
301 重定向
400 请求错误
401 未授权
403 请求被拒绝
404 不存在
405 这个HTTP请求方法不支持
500 服务器错误
502 网关错误
504 网关超时

## TCP & UDP ##

### tcp ###

#### 三次握手 ####

为什么要三次握手？
增加第三次握手的过程是为了，防止在第一次握手的过程因为网络问题，导致没有及时的被服务器收到。然后客户端再次向服务端发起连接请求，然后第一次超时的连接到达了服务端，然后会开启多个tcp连接。如果延迟到达的请求过多，会导致服务器开启段连接过多，导致服务器异常。

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/e92d0ebc-7d46-413b-aec1-34a39602f787.png)

第三次握手的原因：

增加第三次握手的过程是为了，防止在第一次握手的过程因为网络问题，导致没有及时的被服务器收到。然后客户端再次向服务端发起连接请求，然后第一次超时的连接到达了服务端，然后会开启多个tcp连接。如果延迟到达的请求过多，会导致服务器开启段连接过多，导致服务器异常。

#### 四次挥手 ####

为什么要四次挥手？
因为tcp是双工的，数据的传输是双向的。四次挥手中的前两次挥手，是客户端将客户端向服务端传输数据的过程断开，后两次挥手是服务端断开服务端对客户端的数据传输。中间的过程是服务端对客户端数据的单向传输。

第四次挥手发出之后，客户端为什么要等待两个MSL？
如果第四次挥手没有按时抵达服务端，那么服务端会在第三次挥手发出的2MSL（也就是第四次挥手发出后的1MSL）后，重新发出第三次挥手。这次重新发出的挥手，会在失败的第四次挥手发出后的2MSL到达客户端。这也就是2MSL等待时间的由来，TIME_WAIT。

![](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/f87afe72-c2df-4c12-ac03-9b8d581a8af8.jpg)
为什么要四次挥手？
因为tcp是双工的，数据的传输是双向的。四次挥手中的前两次挥手，是客户端将客户端向服务端传输数据的过程断开，后两次挥手是服务端断开服务端对客户端的数据传输。中间的过程是服务端对客户端数据的单向传输。

第四次挥手发出之后，客户端为什么要等待两个MSL？
如果第四次挥手没有按时抵达服务端，那么服务端会在第三次挥手发出的2MSL（也就是第四次挥手发出后的1MSL）后，重新发出第三次挥手。这次重新发出的挥手，会在失败的第四次挥手发出后的2MSL到达客户端。这也就是2MSL等待时间的由来，TIME_WAIT。



#### 流量控制 ####

发送方通过接受方返回的确认报文中的的窗口大小来调整发送方的滑动窗口的大小。从而影响发送速率。

#### 拥塞控制 ####

1. 慢开启 从1开始两倍增加
2. 拥塞避免 当到达 ssthresh 之后，每次增加一个
3. 快恢复 当出现超时时，将传输量降低到超时时的传输量的一半
4. 快重传 当传输丢失，接收方没有收到某个报文时，接收方连续对丢失报文的进行三次确认，发送方立即重新发送该报文

### udp ###

1. udp无连接
2. 支持一对一、一对多
3. 面向报文
4. 尽力交付，不可靠


#### 区别 ####

1. 连接上：tcp 在连接时会进行三次握手的过程，但是udp没有连接的过程
2. 传输上：tcp 会确保数据传输到达，但是udp不会。tcp 存在确认机制，会确认数据传输到，如果超时没有进行确认，会进行超时重传。
3. 速率上：tcp 有拥塞控制和流量控制，来控制传输的速度，udp没有类似的机制来控制传输的速度。
4. 传输单元上：tcp 是字节流，udp 是报文。